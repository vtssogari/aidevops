- name: images
  command : 
    cmd: "docker pull {{ item.name }}:{{ item.version }}"
  loop: "{{ docker_images }}"   

- name: Create a directory if it does not exist
  ansible.builtin.file:
    path: "{{ archived_folder }}"
    state: directory
    mode: '0755'

- name: archive images
  command : 
    cmd: "docker save -o {{ archived_folder }}/{{ item.tar_name }}.tar {{ item.name }}:{{ item.version }}"
  loop: "{{ docker_images }}"